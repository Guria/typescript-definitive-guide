# Публикация

![Chapter Cover](./images/chapter-cover.png)

## Публикация

Для того чтобы подключать создаваемые декларации _.d.ts_ с помощью пакетного менеджера _npm_, её нужно определить как npm пакет (npm package). В дальнейшем этот пакет можно опубликовать, с помощью того же пакетного менеджера _npm_, в npm репозиторий, который может быть как публичный, доступный всем разработчикам, так и приватный, доступный только автору\команде. Кроме того можно и вовсе обойтись без публикации в репозиторий, подключая пакет с локального диска. Сама публикация здесь рассматриваться не будет, с этим процессом можно ознакомится в документации к пакетному менеджеру _npm_, но не будет лишнем упомянуть о тонкостях, которые привнес _TypeScript_.

Говоря о создании npm пакета, мы подразумеваем создание описания нашего кода в файле с названием _package.json_. Для того, чтобы компилятор _TypeScript_ смог использовать декларацию _.d.ts_, ему нужно помочь, присвоив полю `types` путь до неё.

```typescript
// package.json

{
   "types": "path to file declaration .d.ts"
}
```

Помимо этого с помощью поля `typesVersion` можно указать декларацию в зависимости от версии _TypeScript_.

```typescript
// package.json

{
   "typesVersions": {
       ">=3.1": { "*": ["ts3.1/index.d.ts"] }
   }
}
```

В случае, если версия среды _TypeScript_ не подпадает под указанный диапазон, то разрешение кода будет выполнено с помощью декларации указанной в поле `types`.

```typescript
// package.json

{

   "typesVersions": {
       ">=3.1": { "*": ["ts3.1/index.d.ts"] } // если версия TypeScript выше либо равна 3.1
   }

   // если версия TypeScript ниже версии 3.1, то будет выбрана декларация указана в поле types

     "types": "./dest/index.d.ts", // если версия TypeScript ниже версии 3.1
}
```

Правила разрешающие использование версий библиотек _TypeScript_ полностью идентичны правилам диапазонов версионирования _nodejs_ [ranges](https://github.com/npm/node-semver#ranges).

Кроме того, можно указывать несколько диапазонов одновременно. Но нужно помнить, что порядок указания диапазонов важен, так как они могут перекрывать друг друга.

```typescript
{
   "typesVersions": {
       ">=3.2": { "*": ["ts3.2/index.d.ts"] },
       ">=3.1": { "*": ["ts3.1/index.d.ts"] }
   }
}
```
